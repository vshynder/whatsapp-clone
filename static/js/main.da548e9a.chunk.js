(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{103:function(e,t){},107:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(15),l=a.n(c),o=a(6);function s(e,t){var a="whatsapp-clone-"+e,r=Object(n.useState)((function(){var e=localStorage.getItem(a);return null!=e?JSON.parse(e):"function"===typeof t?t():t})),c=Object(o.a)(r,2),l=c[0],s=c[1];return Object(n.useEffect)((function(){localStorage.setItem(a,JSON.stringify(l))}),[a,l]),[l,s]}var u=a(110),i=a(114),m=a(111),f=a(115);function d(e){var t=e.onIdSubmit,a=Object(n.useRef)();return r.a.createElement(u.a,{className:"align-items-center d-flex",style:{height:"100vh"}},r.a.createElement(i.a,{onSubmit:function(e){e.preventDefault(),t(a.current.value)},className:"w-100"},r.a.createElement(i.a.Group,null,r.a.createElement(i.a.Label,null,"Enter Your Id"),r.a.createElement(i.a.Control,{type:"text",ref:a,required:!0})),r.a.createElement(m.a,{className:"mr-2",type:"submit"},"Login"),r.a.createElement(m.a,{onClick:function(){t(Object(f.a)())},variant:"secondary"},"Create a new ID")))}var v=a(117),E=a(116),b=a(113),p=a(118),g=a(18),j=a(16),O=r.a.createContext();function x(){return Object(n.useContext)(O)}function C(e){var t=e.children,a=s("contacts",[]),n=Object(o.a)(a,2),c=n[0],l=n[1];return r.a.createElement(O.Provider,{value:{contacts:c,createContact:function(e,t){l((function(a){return[].concat(Object(j.a)(a),[{id:e,name:t}])}))}}},t)}var y=a(62),h=a.n(y),N=r.a.createContext();function S(e){var t=e.id,a=e.children,c=Object(n.useState)(),l=Object(o.a)(c,2),s=l[0],u=l[1];return Object(n.useEffect)((function(){var e=h()("https://mysterious-sea-91181.herokuapp.com/",{query:{id:t}});return u(e),function(){return e.close()}}),[t]),r.a.createElement(N.Provider,{value:s},a)}var I=r.a.createContext();function k(){return Object(n.useContext)(I)}function w(e){var t=e.id,a=e.children,c=s("conversations",[]),l=Object(o.a)(c,2),u=l[0],i=l[1],m=Object(n.useState)(0),f=Object(o.a)(m,2),d=f[0],v=f[1],E=x().contacts,b=Object(n.useContext)(N),p=Object(n.useCallback)((function(e){var t=e.recipients,a=e.text,n=e.sender;i((function(e){var r=!1,c={sender:n,text:a},l=e.map((function(e){return a=e.recipients,n=t,a.length===n.length&&(a.sort(),n.sort(),a.every((function(e,t){return e===n[t]})))?(r=!0,Object(g.a)(Object(g.a)({},e),{},{messages:[].concat(Object(j.a)(e.messages),[c])})):e;var a,n}));return r?l:[].concat(Object(j.a)(e),[{recipients:t,messages:[c]}])}))}),[i]);Object(n.useEffect)((function(){if(null!=b)return b.on("recieve-message",p),function(){return b.off("recieve-message")}}),[b,p]);var O=u.map((function(e,a){var n=e.recipients.map((function(e){var t=E.find((function(t){return t.id===e})),a=t&&t.name||e;return{id:e,name:a}})),r=e.messages.map((function(e){var a=E.find((function(t){return t.id===e.sender})),n=a&&a.name||e.sender,r=t===e.sender;return Object(g.a)(Object(g.a)({},e),{},{senderName:n,fromMe:r})})),c=a===d;return Object(g.a)(Object(g.a)({},e),{},{messages:r,recipients:n,selected:c})}));return r.a.createElement(I.Provider,{value:{conversations:O,selectedConversation:O[d],sendMessage:function(e,a){b.emit("send-message",{recipients:e,text:a}),p({recipients:e,text:a,sender:t})},selectConversationIndex:v,createConversation:function(e){i((function(t){return[].concat(Object(j.a)(t),[{recipients:e,messages:[]}])}))}}},a)}function M(){var e=k(),t=e.conversations,a=e.selectConversationIndex;return r.a.createElement(p.a,{variant:"flush"},t.map((function(e,t){return r.a.createElement(p.a.Item,{key:t,action:!0,onClick:function(){return a(t)},active:e.selected},e.recipients.map((function(e){return e.name})).join(", "))})))}function L(){var e=x().contacts;return r.a.createElement(p.a,{variant:"flush"},e.map((function(e){return r.a.createElement(p.a.Item,{key:e.id},e.name)})))}function q(e){var t=e.closeModal,a=Object(n.useState)([]),c=Object(o.a)(a,2),l=c[0],s=c[1],u=x().contacts,f=k().createConversation;return r.a.createElement(r.a.Fragment,null,r.a.createElement(b.a.Header,{closeButton:!0},"Create conversation"),r.a.createElement(b.a.Body,null,r.a.createElement(i.a,{onSubmit:function(e){e.preventDefault(),f(l),t()}},u.map((function(e){return r.a.createElement(i.a.Group,{controlId:e.id,key:e.id},r.a.createElement(i.a.Check,{rype:"checkbox",value:l.includes(e.id),label:e.name,onChange:function(){return t=e.id,void s((function(e){return e.includes(t)?e.filter((function(e){return t!==e})):[].concat(Object(j.a)(e),[t])}));var t}}))})),r.a.createElement(m.a,{type:"submit"},"Create"))))}function B(e){var t=e.closeModal,a=Object(n.useRef)(),c=Object(n.useRef)(),l=x().createContact;return r.a.createElement(r.a.Fragment,null,r.a.createElement(b.a.Header,{closeButton:!0},"Create contact"),r.a.createElement(b.a.Body,null,r.a.createElement(i.a,{onSubmit:function(e){e.preventDefault(),l(a.current.value,c.current.value),t()}},r.a.createElement(i.a.Group,null,r.a.createElement(i.a.Label,null,"Id"),r.a.createElement(i.a.Control,{type:"text",ref:a,required:!0})),r.a.createElement(i.a.Group,null,r.a.createElement(i.a.Label,null,"Name"),r.a.createElement(i.a.Control,{type:"text",ref:c,required:!0})),r.a.createElement(m.a,{type:"submit"},"Create"))))}function D(e){var t=e.id,a=Object(n.useState)("conversations"),c=Object(o.a)(a,2),l=c[0],s=c[1],u=Object(n.useState)(!1),i=Object(o.a)(u,2),f=i[0],d=i[1],p="conversations"===l,g=function(){d(!1)};return r.a.createElement("div",{style:{width:"250px"},className:"d-flex flex-column"},r.a.createElement(v.a.Container,{activeKey:l,onSelect:s},r.a.createElement(E.a,{variant:"tabs",className:"justify-contect-center"},r.a.createElement(E.a.Item,null,r.a.createElement(E.a.Link,{eventKey:"conversations"},"Conversations")),r.a.createElement(E.a.Item,null,r.a.createElement(E.a.Link,{eventKey:"contacts"},"Contacts"))),r.a.createElement(v.a.Content,{className:"border-right overflow-auto flex-grow-1"},r.a.createElement(v.a.Pane,{eventKey:"conversations"},r.a.createElement(M,null)),r.a.createElement(v.a.Pane,{eventKey:"contacts"},r.a.createElement(L,null))),r.a.createElement("div",{className:"p-2 border-top border-right small"},"Your Id: ",r.a.createElement("span",{className:"text-muted"},t)),r.a.createElement(m.a,{onClick:function(){return d(!0)},className:"rounded-0"},"New ",p?"Conversation":"Contact")),r.a.createElement(b.a,{show:f,onHide:g},p?r.a.createElement(q,{closeModal:g}):r.a.createElement(B,{closeModal:g})))}var G=a(112);function K(){var e=Object(n.useState)(),t=Object(o.a)(e,2),a=t[0],c=t[1],l=Object(n.useCallback)((function(e){e&&e.scrollIntoView({smooth:!0})}),[]),s=k(),u=s.sendMessage,f=s.selectedConversation;return r.a.createElement("div",{className:"d-flex flex-column flex-grow-1"},r.a.createElement("div",{className:"flex-grow-1 overflow-auto"},r.a.createElement("div",{className:"d-flex flex-column align-items-start justify-content-end px-3"},f.messages.map((function(e,t){var a=f.messages.length-1===t;return r.a.createElement("div",{ref:a?l:null,key:t,className:"my-1 d-flex flex-column ".concat(e.fromMe?"align-self-end align-items-end":"align-items-start")},r.a.createElement("div",{className:"rounded px-2 py-1 ".concat(e.fromMe?"bg-primary text-white":"border")},e.text),r.a.createElement("div",{className:"text-muted small ".concat(e.fromMe?"text-right":"")},e.fromMe?"You":e.senderName))})))),r.a.createElement(i.a,{onSubmit:function(e){e.preventDefault(),console.log(f),u(f.recipients.map((function(e){return e.id})),a),c("")}},r.a.createElement(i.a.Group,{className:"m-2"},r.a.createElement(G.a,null,r.a.createElement(i.a.Control,{as:"textarea",required:!0,value:a,onChange:function(e){return c(e.target.value)},style:{height:"75px",resize:"none"}}),r.a.createElement(G.a.Append,null,r.a.createElement(m.a,{type:"submit"},"Send"))))))}function P(e){var t=e.id,a=k().selectedConversation;return r.a.createElement("div",{className:"d-flex",style:{height:"100vh"}},r.a.createElement(D,{id:t}),a&&r.a.createElement(K,null))}var J=function(){var e=s("id"),t=Object(o.a)(e,2),a=t[0],n=t[1];return a?r.a.createElement(S,{id:a},r.a.createElement(C,null,r.a.createElement(w,{id:a},r.a.createElement(P,{id:a})))):r.a.createElement(d,{onIdSubmit:n})};a(106);l.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(J,null)),document.getElementById("root"))},69:function(e,t,a){e.exports=a(107)}},[[69,1,2]]]);
//# sourceMappingURL=main.da548e9a.chunk.js.map